import{r as a,q as F,aJ as ie,a as ae,s as u,j as e,a0 as oe,C as x,T as le,S as c,I as K,Q as ce,i as G,M as de,A as z,b as H,f as m,p as T,B as he,x as b,y as me}from"./index-bcuI966E.js";import{R as k}from"./CheckOutlined-9npqoSUv.js";import{R as ue}from"./SearchOutlined-D2gRiFxI.js";import{S as C}from"./index-COd8B_t3.js";import{F as pe}from"./Table-BovAFv33.js";import{R as $}from"./index-Ciy63vs3.js";import{P as D}from"./index-BqnuXQlz.js";import{R as M}from"./DeleteOutlined-CNMFFws8.js";import{R as Z}from"./WarningOutlined-CqXox8Gs.js";import{R as ge}from"./LikeOutlined-CeA7IoEf.js";import"./DownOutlined-DeH2MZMn.js";import"./addEventListener-CwuRzLNG.js";import"./Pagination-KlOrN12m.js";var xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"};function w(){return w=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var d in l)Object.prototype.hasOwnProperty.call(l,d)&&(o[d]=l[d])}return o},w.apply(this,arguments)}const je=(o,s)=>a.createElement(F,w({},o,{ref:s,icon:ie})),R=a.forwardRef(je);function I(){return I=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var d in l)Object.prototype.hasOwnProperty.call(l,d)&&(o[d]=l[d])}return o},I.apply(this,arguments)}const ve=(o,s)=>a.createElement(F,I({},o,{ref:s,icon:xe})),fe=a.forwardRef(ve),ye=[{id:1,movieId:1,movieTitle:"Avengers: Endgame",userId:1,userName:"Nguyễn Văn An",userAvatar:"https://image.tmdb.org/t/p/w500/kbNyaREVYRZPfGHdQHBxaxU0DVv.jpg",rating:9,comment:"Phim thật sự tuyệt vời! Cảnh chiến đấu cuối rất hoành tráng và cảm động. Marvel đã tạo ra một kết thúc hoàn hảo cho saga Infinity.",createdAt:"2024-01-15T10:30:00Z",status:"approved",likes:45,reports:0,isReported:!1,reportReasons:[]},{id:2,movieId:1,movieTitle:"Avengers: Endgame",userId:2,userName:"Trần Thị Bình",userAvatar:"https://image.tmdb.org/t/p/w500/kbNyaREVYRZPfGHdQHBxaxU0DVv.jpg",rating:10,comment:"Xuất sắc từ đầu đến cuối! Tony Stark đã hy sinh thật anh hùng. Tôi đã khóc rất nhiều ở cuối phim. 10/10 ⭐",createdAt:"2024-01-14T15:20:00Z",status:"approved",likes:78,reports:0,isReported:!1,reportReasons:[]},{id:3,movieId:2,movieTitle:"Ma Không Đầu",userId:3,userName:"Lê Minh Đức",userAvatar:"https://image.tmdb.org/t/p/w500/kbNyaREVYRZPfGHdQHBxaxU0DVv.jpg",rating:7,comment:"Phim hài kinh dị khá hay, có những tình tiết gây cười. Tuy nhiên cốt truyện hơi lỗ hổng ở một số chỗ.",createdAt:"2024-01-13T09:45:00Z",status:"approved",likes:23,reports:0,isReported:!1,reportReasons:[]},{id:4,movieId:1,movieTitle:"Avengers: Endgame",userId:4,userName:"Phạm Thị Lan",userAvatar:"https://image.tmdb.org/t/p/w500/kbNyaREVYRZPfGHdQHBxaxU0DVv.jpg",rating:5,comment:"Phim dài quá, có nhiều chỗ chán. Tôi nghĩ họ đã kéo dài câu chuyện một cách không cần thiết. Cũng không hay lắm.",createdAt:"2024-01-12T14:10:00Z",status:"pending",likes:12,reports:2,isReported:!0,reportReasons:["Nội dung tiêu cực","Spam"]},{id:5,movieId:2,movieTitle:"Ma Không Đầu",userId:5,userName:"Hoàng Văn Tùng",userAvatar:"https://image.tmdb.org/t/p/w500/kbNyaREVYRZPfGHdQHBxaxU0DVv.jpg",rating:8,comment:"Phim Việt Nam ngày càng chất lượng hơn! Diễn xuất của các diễn viên rất tự nhiên, đặc biệt là cảnh hài.",createdAt:"2024-01-11T16:30:00Z",status:"approved",likes:34,reports:0,isReported:!1,reportReasons:[]},{id:6,movieId:1,movieTitle:"Avengers: Endgame",userId:6,userName:"Vũ Thị Mai",userAvatar:"https://image.tmdb.org/t/p/w500/kbNyaREVYRZPfGHdQHBxaxU0DVv.jpg",rating:2,comment:"Phim rất tệ! Hoàn toàn không hiểu nội dung gì cả. Lãng phí tiền và thời gian. Các siêu anh hùng này chỉ là trò hề thôi!!!",createdAt:"2024-01-10T11:20:00Z",status:"rejected",likes:3,reports:15,isReported:!0,reportReasons:["Ngôn ngữ không phù hợp","Nội dung tiêu cực","Spam","Hate speech"]},{id:7,movieId:2,movieTitle:"Ma Không Đầu",userId:7,userName:"Đỗ Minh Quân",userAvatar:"https://image.tmdb.org/t/p/w500/kbNyaREVYRZPfGHdQHBxaxU0DVv.jpg",rating:9,comment:"Tôi rất thích phong cách làm phim này. Kết hợp giữa kinh dị và hài hước rất tinh tế. Đáng xem!",createdAt:"2024-01-09T20:15:00Z",status:"approved",likes:56,reports:0,isReported:!1,reportReasons:[]},{id:8,movieId:1,movieTitle:"Avengers: Endgame",userId:8,userName:"Bùi Thị Hương",userAvatar:"https://image.tmdb.org/t/p/w500/kbNyaREVYRZPfGHdQHBxaxU0DVv.jpg",rating:6,comment:"Phim OK nhưng hơi dài dòng. Một số cảnh hành động khá ấn tượng nhưng cốt truyện có thể rút ngắn hơn.",createdAt:"2024-01-08T13:45:00Z",status:"pending",likes:18,reports:1,isReported:!0,reportReasons:["Nội dung không phù hợp"]}],{Title:O,Text:i,Paragraph:Q}=le,{TextArea:Ee}=K,{Option:j}=C,{TabPane:Pe}=G,ze=()=>{const o=ae(),[s,l]=a.useState([]),[d,U]=a.useState([]),[Y,A]=a.useState(!0),[p,X]=a.useState(""),[v,_]=a.useState("all"),[f,q]=a.useState("all"),[r,N]=a.useState(null),[J,g]=a.useState(!1),[y,W]=a.useState("all");a.useEffect(()=>{ee()},[]),a.useEffect(()=>{te()},[s,p,v,f,y]);const ee=async()=>{try{A(!0),l(ye)}catch(t){console.error("Error loading comments:",t),u.error("Lỗi khi tải danh sách bình luận")}finally{A(!1)}},te=()=>{let t=[...s];y!=="all"&&(t=t.filter(n=>n.status===y)),p&&(t=t.filter(n=>n.comment.toLowerCase().includes(p.toLowerCase())||n.userName.toLowerCase().includes(p.toLowerCase())||n.movieTitle.toLowerCase().includes(p.toLowerCase()))),v!=="all"&&(t=t.filter(n=>n.status===v)),f!=="all"&&(t=t.filter(n=>n.movieId===parseInt(f))),U(t)},S=async t=>{try{const n=s.map(h=>h.id===t?{...h,status:"approved"}:h);l(n),u.success("Đã duyệt bình luận")}catch(n){console.error("Error approving comment:",n),u.error("Lỗi khi duyệt bình luận")}},B=async t=>{try{const n=s.map(h=>h.id===t?{...h,status:"rejected"}:h);l(n),u.success("Đã từ chối bình luận")}catch(n){console.error("Error rejecting comment:",n),u.error("Lỗi khi từ chối bình luận")}},L=async t=>{try{const n=s.filter(h=>h.id!==t);l(n),u.success("Đã xóa bình luận")}catch(n){console.error("Error deleting comment:",n),u.error("Lỗi khi xóa bình luận")}},ne=t=>{N(t),g(!0)},V=t=>new Date(t).toLocaleString("vi-VN"),E=t=>{switch(t){case"approved":return"green";case"pending":return"orange";case"rejected":return"red";default:return"default"}},P=t=>{switch(t){case"approved":return"Đã duyệt";case"pending":return"Chờ duyệt";case"rejected":return"Đã từ chối";default:return t}},se=[{title:"Người dùng",key:"user",width:200,render:(t,n)=>e.jsxs(c,{children:[e.jsx(z,{src:n.userAvatar,icon:e.jsx(H,{})}),e.jsxs("div",{children:[e.jsx(i,{strong:!0,children:n.userName}),e.jsx("br",{}),e.jsxs(i,{type:"secondary",style:{fontSize:"12px"},children:["ID: ",n.userId]})]})]})},{title:"Phim",dataIndex:"movieTitle",key:"movieTitle",width:150,render:(t,n)=>e.jsx(m,{type:"link",onClick:()=>o(`/admin/movies/${n.movieId}`),style:{padding:0,height:"auto"},children:t})},{title:"Đánh giá",dataIndex:"rating",key:"rating",width:120,render:t=>e.jsxs(c,{children:[e.jsx($,{disabled:!0,value:t,style:{fontSize:"14px"}}),e.jsxs(i,{children:[t,"/10"]})]})},{title:"Bình luận",dataIndex:"comment",key:"comment",render:t=>e.jsx(Q,{ellipsis:{rows:2,expandable:!1},style:{margin:0,maxWidth:"300px"},children:t})},{title:"Ngày tạo",dataIndex:"createdAt",key:"createdAt",width:140,render:t=>V(t)},{title:"Trạng thái",dataIndex:"status",key:"status",width:120,render:(t,n)=>e.jsxs(c,{direction:"vertical",size:4,children:[e.jsx(T,{color:E(t),children:P(t)}),n.isReported&&e.jsx(he,{count:n.reports,size:"small",children:e.jsx(T,{color:"red",icon:e.jsx(Z,{}),children:"Bị báo cáo"})})]})},{title:"Tương tác",key:"interactions",width:100,render:(t,n)=>e.jsxs(c,{direction:"vertical",size:4,children:[e.jsxs(i,{style:{fontSize:"12px"},children:[e.jsx(ge,{})," ",n.likes]}),n.reports>0&&e.jsxs(i,{style:{fontSize:"12px",color:"red"},children:[e.jsx(Z,{})," ",n.reports]})]})},{title:"Thao tác",key:"actions",width:200,render:(t,n)=>e.jsxs(c,{children:[e.jsx(b,{title:"Xem chi tiết",children:e.jsx(m,{icon:e.jsx(me,{}),size:"small",onClick:()=>ne(n)})}),n.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(b,{title:"Duyệt bình luận",children:e.jsx(m,{icon:e.jsx(k,{}),size:"small",type:"primary",onClick:()=>S(n.id)})}),e.jsx(b,{title:"Từ chối",children:e.jsx(m,{icon:e.jsx(R,{}),size:"small",danger:!0,onClick:()=>B(n.id)})})]}),e.jsx(D,{title:"Xóa bình luận",description:"Bạn có chắc chắn muốn xóa bình luận này?",onConfirm:()=>L(n.id),okText:"Có",cancelText:"Không",children:e.jsx(b,{title:"Xóa",children:e.jsx(m,{icon:e.jsx(M,{}),size:"small",danger:!0})})})]})}],re=[{key:"all",label:`Tất cả (${s.length})`,icon:e.jsx(oe,{})},{key:"pending",label:`Chờ duyệt (${s.filter(t=>t.status==="pending").length})`,icon:e.jsx(fe,{})},{key:"approved",label:`Đã duyệt (${s.filter(t=>t.status==="approved").length})`,icon:e.jsx(k,{})},{key:"rejected",label:`Đã từ chối (${s.filter(t=>t.status==="rejected").length})`,icon:e.jsx(R,{})}];return e.jsxs("div",{className:"comments-container",children:[e.jsxs(x,{className:"comments-header",children:[e.jsx(O,{level:2,style:{margin:0,marginBottom:"16px"},children:"Quản lý Bình luận"}),e.jsxs(c,{wrap:!0,size:"middle",children:[e.jsx(K,{placeholder:"Tìm kiếm bình luận...",prefix:e.jsx(ue,{}),value:p,onChange:t=>X(t.target.value),style:{width:"250px"}}),e.jsxs(C,{placeholder:"Lọc theo phim",value:f,onChange:q,style:{width:"200px"},children:[e.jsx(j,{value:"all",children:"Tất cả phim"}),ce.map(t=>e.jsx(j,{value:t.id.toString(),children:t.title},t.id))]}),e.jsxs(C,{placeholder:"Lọc theo trạng thái",value:v,onChange:_,style:{width:"150px"},children:[e.jsx(j,{value:"all",children:"Tất cả"}),e.jsx(j,{value:"pending",children:"Chờ duyệt"}),e.jsx(j,{value:"approved",children:"Đã duyệt"}),e.jsx(j,{value:"rejected",children:"Đã từ chối"})]})]})]}),e.jsxs(x,{children:[e.jsx(G,{activeKey:y,onChange:W,items:re}),e.jsx(pe,{columns:se,dataSource:d,rowKey:"id",loading:Y,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,n)=>`${n[0]}-${n[1]} của ${t} bình luận`},scroll:{x:1200}})]}),e.jsx(de,{title:"Chi tiết bình luận",open:J,onCancel:()=>{g(!1),N(null)},footer:null,width:800,children:r&&e.jsxs("div",{children:[e.jsx(x,{title:"Thông tin người dùng",size:"small",style:{marginBottom:"16px"},children:e.jsxs(c,{children:[e.jsx(z,{src:r.userAvatar,size:64,icon:e.jsx(H,{})}),e.jsxs("div",{children:[e.jsx(O,{level:4,style:{margin:0},children:r.userName}),e.jsxs(i,{type:"secondary",children:["ID: ",r.userId]})]})]})}),e.jsx(x,{title:"Thông tin phim",size:"small",style:{marginBottom:"16px"},children:e.jsxs(c,{children:[e.jsx(i,{strong:!0,children:"Phim:"}),e.jsx(m,{type:"link",onClick:()=>{g(!1),o(`/admin/movies/${r.movieId}`)},children:r.movieTitle})]})}),e.jsx(x,{title:"Nội dung bình luận",size:"small",style:{marginBottom:"16px"},children:e.jsxs(c,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(i,{strong:!0,children:"Đánh giá: "}),e.jsx($,{disabled:!0,value:r.rating}),e.jsxs(i,{style:{marginLeft:"8px"},children:[r.rating,"/10"]})]}),e.jsxs("div",{children:[e.jsx(i,{strong:!0,children:"Bình luận:"}),e.jsx(Q,{style:{marginTop:"8px",padding:"12px",background:"#f5f5f5",borderRadius:"6px"},children:r.comment})]}),e.jsxs("div",{children:[e.jsx(i,{strong:!0,children:"Ngày tạo: "}),e.jsx(i,{children:V(r.createdAt)})]})]})}),e.jsx(x,{title:"Trạng thái & Thống kê",size:"small",style:{marginBottom:"16px"},children:e.jsxs(c,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(i,{strong:!0,children:"Trạng thái: "}),e.jsx(T,{color:E(r.status),children:P(r.status)})]}),e.jsxs("div",{children:[e.jsx(i,{strong:!0,children:"Lượt thích: "}),e.jsx(i,{children:r.likes})]}),e.jsxs("div",{children:[e.jsx(i,{strong:!0,children:"Lượt báo cáo: "}),e.jsx(i,{children:r.reports})]}),r.reportReasons.length>0&&e.jsxs("div",{children:[e.jsx(i,{strong:!0,children:"Lý do báo cáo: "}),e.jsx(c,{wrap:!0,children:r.reportReasons.map((t,n)=>e.jsx(T,{color:"red",children:t},n))})]})]})}),e.jsx("div",{style:{textAlign:"right"},children:e.jsxs(c,{children:[r.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{type:"primary",icon:e.jsx(k,{}),onClick:()=>{S(r.id),g(!1)},children:"Duyệt bình luận"}),e.jsx(m,{danger:!0,icon:e.jsx(R,{}),onClick:()=>{B(r.id),g(!1)},children:"Từ chối"})]}),e.jsx(D,{title:"Xóa bình luận",description:"Bạn có chắc chắn muốn xóa bình luận này?",onConfirm:()=>{L(r.id),g(!1)},okText:"Có",cancelText:"Không",children:e.jsx(m,{danger:!0,icon:e.jsx(M,{}),children:"Xóa bình luận"})})]})})]})})]})};export{ze as default};
